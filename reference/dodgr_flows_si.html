<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregate flows throughout a network using a spatial interaction model. — dodgr_flows_si • dodgr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate flows throughout a network using a spatial interaction model. — dodgr_flows_si"><meta name="description" content="Aggregate flows throughout a network using an exponential
Spatial Interaction (SI) model between a specified set of origin and
destination points, and associated vectors of densities. Spatial
interactions are implemented using an exponential decay, controlled by a
parameter, k, so that interactions decay with exp(-d / k), where d is
distance. The algorithm allows for efficient fitting of multiple interaction
models for different coefficients to be fitted with a single call. Values of
the interaction coefficients, k, may take one of the following forms:

A single numeric value (&amp;gt; 0), with interactions along all paths
calculated with that single value. Return object (see below) will then have
a single additional column named &quot;flow&quot;.
A vector of length equal to the number of from points, with
interactions from each point then calculated using the corresponding value
of k. Return object has single additional &quot;flow&quot; column.
A vector of any other length (that is, &amp;gt;  1 yet different to number of
from points), in which case different interaction models will be fitted
for each of the n specified values, and the resultant return object will
have an additional 'n' columns, named 'flow1', 'flow2', ... up to 'n'. These
columns must be subsequently matched by the user back on to the
corresponding 'k' values.
A matrix with number of rows equal to the number of from points, and
any number of columns. Each column will then specify a distinct interaction
model, with different values from each row applied to the corresponding
from points. The return value will then be the same as the previous
version, with an additional n columns, &quot;flow1&quot; to &quot;flown&quot;.


Flows are calculated by default on contracted graphs, via the contract = TRUE parameter. (These are derived by reducing the input graph down to
junction vertices only, by joining all intermediate edges between each
junction.) If changes to the input graph do not prompt changes to resultant
flows, and the default contract = TRUE is used, it may be that
calculations are using previously cached versions of the contracted graph.
If so, please use either clear_dodgr_cache to remove the cached
version, or dodgr_cache_off prior to initial graph construction to
switch the cache off completely."><meta property="og:description" content="Aggregate flows throughout a network using an exponential
Spatial Interaction (SI) model between a specified set of origin and
destination points, and associated vectors of densities. Spatial
interactions are implemented using an exponential decay, controlled by a
parameter, k, so that interactions decay with exp(-d / k), where d is
distance. The algorithm allows for efficient fitting of multiple interaction
models for different coefficients to be fitted with a single call. Values of
the interaction coefficients, k, may take one of the following forms:

A single numeric value (&amp;gt; 0), with interactions along all paths
calculated with that single value. Return object (see below) will then have
a single additional column named &quot;flow&quot;.
A vector of length equal to the number of from points, with
interactions from each point then calculated using the corresponding value
of k. Return object has single additional &quot;flow&quot; column.
A vector of any other length (that is, &amp;gt;  1 yet different to number of
from points), in which case different interaction models will be fitted
for each of the n specified values, and the resultant return object will
have an additional 'n' columns, named 'flow1', 'flow2', ... up to 'n'. These
columns must be subsequently matched by the user back on to the
corresponding 'k' values.
A matrix with number of rows equal to the number of from points, and
any number of columns. Each column will then specify a distinct interaction
model, with different values from each row applied to the corresponding
from points. The return value will then be the same as the previous
version, with an additional n columns, &quot;flow1&quot; to &quot;flown&quot;.


Flows are calculated by default on contracted graphs, via the contract = TRUE parameter. (These are derived by reducing the input graph down to
junction vertices only, by joining all intermediate edges between each
junction.) If changes to the input graph do not prompt changes to resultant
flows, and the default contract = TRUE is used, it may be that
calculations are using previously cached versions of the contracted graph.
If so, please use either clear_dodgr_cache to remove the cached
version, or dodgr_cache_off prior to initial graph construction to
switch the cache off completely."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dodgr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.3.014</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UrbanAnalyst/dodgr"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregate flows throughout a network using a spatial interaction model.</h1>
      <small class="dont-index">Source: <a href="https://github.com/UrbanAnalyst/dodgr/blob/main/R/flows.R" class="external-link"><code>R/flows.R</code></a></small>
      <div class="d-none name"><code>dodgr_flows_si.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Aggregate flows throughout a network using an exponential
Spatial Interaction (SI) model between a specified set of origin and
destination points, and associated vectors of densities. Spatial
interactions are implemented using an exponential decay, controlled by a
parameter, <code>k</code>, so that interactions decay with <code>exp(-d / k)</code>, where <code>d</code> is
distance. The algorithm allows for efficient fitting of multiple interaction
models for different coefficients to be fitted with a single call. Values of
the interaction coefficients, <code>k</code>, may take one of the following forms:</p>
<ul><li><p>A single numeric value (&gt; 0), with interactions along all paths
calculated with that single value. Return object (see below) will then have
a single additional column named "flow".</p></li>
<li><p>A vector of length equal to the number of <code>from</code> points, with
interactions from each point then calculated using the corresponding value
of <code>k</code>. Return object has single additional "flow" column.</p></li>
<li><p>A vector of any other length (that is, &gt;  1 yet different to number of
<code>from</code> points), in which case different interaction models will be fitted
for each of the <code>n</code> specified values, and the resultant return object will
have an additional 'n' columns, named 'flow1', 'flow2', ... up to 'n'. These
columns must be subsequently matched by the user back on to the
corresponding 'k' values.</p></li>
<li><p>A matrix with number of rows equal to the number of <code>from</code> points, and
any number of columns. Each column will then specify a distinct interaction
model, with different values from each row applied to the corresponding
<code>from</code> points. The return value will then be the same as the previous
version, with an additional <code>n</code> columns, "flow1" to "flown".</p></li>
</ul><p>Flows are calculated by default on contracted graphs, via the <code>contract = TRUE</code> parameter. (These are derived by reducing the input graph down to
junction vertices only, by joining all intermediate edges between each
junction.) If changes to the input graph do not prompt changes to resultant
flows, and the default <code>contract = TRUE</code> is used, it may be that
calculations are using previously cached versions of the contracted graph.
If so, please use either <a href="clear_dodgr_cache.html">clear_dodgr_cache</a> to remove the cached
version, or <a href="dodgr_cache_off.html">dodgr_cache_off</a> prior to initial graph construction to
switch the cache off completely.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dodgr_flows_si</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">from</span>,</span>
<span>  <span class="va">to</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  dens_from <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dens_to <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contract <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  norm_sums <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  heap <span class="op">=</span> <span class="st">"BHeap"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.000000000001</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p><code>data.frame</code> or equivalent object representing the network
graph (see Details)</p></dd>


<dt id="arg-from">from<a class="anchor" aria-label="anchor" href="#arg-from"></a></dt>
<dd><p>Vector or matrix of points <strong>from</strong> which route distances are to
be calculated, specified as one of the following:</p><ul><li><p>Single character vector precisely matching node numbers or names
given in <code>graph$from</code> or <code>graph$to</code>.</p></li>
<li><p>Single vector of integer-ish values, in which case these will be
presumed to specify indices into <a href="dodgr_vertices.html">dodgr_vertices</a>, and NOT to
correspond to values in the 'from' or 'to' columns of the graph. See the
example below for a demonstration.</p></li>
<li><p>Matrix or equivalent of longitude and latitude coordinates, in which
case these will be matched on to the nearest coordinates of 'from' and 'to'
points in the graph.</p></li>
</ul></dd>


<dt id="arg-to">to<a class="anchor" aria-label="anchor" href="#arg-to"></a></dt>
<dd><p>Vector or matrix of points <strong>to</strong> which route distances are to be
calculated. If <code>to</code> is <code>NULL</code>, pairwise distances will be calculated from
all <code>from</code> points to all other nodes in <code>graph</code>. If both <code>from</code> and <code>to</code> are
<code>NULL</code>, pairwise distances are calculated between all nodes in <code>graph</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Width of exponential spatial interaction function (exp (-d / k)),
in units of 'd', specified in one of 3 forms: (i) a single value; (ii) a
vector of independent values for each origin point (with same length as
'from' points); or (iii) an equivalent matrix with each column holding values
for each 'from' point, so 'nrow(k)==length(from)'. See Note.</p></dd>


<dt id="arg-dens-from">dens_from<a class="anchor" aria-label="anchor" href="#arg-dens-from"></a></dt>
<dd><p>Vector of densities at origin ('from') points</p></dd>


<dt id="arg-dens-to">dens_to<a class="anchor" aria-label="anchor" href="#arg-dens-to"></a></dt>
<dd><p>Vector of densities at destination ('to') points</p></dd>


<dt id="arg-contract">contract<a class="anchor" aria-label="anchor" href="#arg-contract"></a></dt>
<dd><p>If <code>TRUE</code> (default), calculate flows on contracted graph
before mapping them back on to the original full graph (recommended as this
will generally be much faster). <code>FALSE</code> should only be used if the <code>graph</code>
has already been contracted.</p></dd>


<dt id="arg-norm-sums">norm_sums<a class="anchor" aria-label="anchor" href="#arg-norm-sums"></a></dt>
<dd><p>Standardise sums from all origin points, so sum of flows
throughout entire network equals sum of densities from all origins (see
Note).</p></dd>


<dt id="arg-heap">heap<a class="anchor" aria-label="anchor" href="#arg-heap"></a></dt>
<dd><p>Type of heap to use in priority queue. Options include
Fibonacci Heap (default; <code>FHeap</code>), Binary Heap (<code>BHeap</code>),
Trinomial Heap (<code>TriHeap</code>), Extended Trinomial Heap
(<code>TriHeapExt</code>, and 2-3 Heap (<code>Heap23</code>).</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Relative tolerance below which flows towards <code>to</code> vertices are not
considered. This will generally have no effect, but can provide speed gains
when flow matrices represent spatial interaction models, in which case this
parameter effectively reduces the radius from each <code>from</code> point over which
flows are aggregated. To remove any such effect, set <code>tol = 0</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>If <code>FALSE</code>, display progress messages on screen.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Modified version of graph with additional <code>flow</code> column added.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The <code>norm_sums</code> parameter should be used whenever densities at origins
and destinations are absolute values, and ensures that the sum of resultant
flow values throughout the entire network equals the sum of densities at all
origins. For example, with <code>norm_sums = TRUE</code> (the default), a flow from a
single origin with density one to a single destination along two edges will
allocate flows of one half to each of those edges, such that the sum of flows
across the network will equal one, or the sum of densities from all origins.
The <code>norm_sums = TRUE</code> option is appropriate where densities are relative
values, and ensures that each edge maintains relative proportions. In the
above example, flows along each of two edges would equal one, for a network
sum of two, or greater than the sum of densities.</p>
<p>With <code>norm_sums = TRUE</code>, the sum of network flows (<code>sum(output$flow)</code>) should
equal the sum of origin densities (<code>sum(dens_from)</code>). This may nevertheless
not always be the case, because origin points may simply be too far from any
destination (<code>to</code>) points for an exponential model to yield non-zero values
anywhere in a network within machine tolerance. Such cases may result in sums
of output flows being less than sums of input densities.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other flows:
<code><a href="dodgr_flows_aggregate.html">dodgr_flows_aggregate</a>()</code>,
<code><a href="dodgr_flows_disperse.html">dodgr_flows_disperse</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># This is generally needed to explore different values of `k` on same graph:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dodgr_cache_off.html">dodgr_cache_off</a></span> <span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="weight_streetnet.html">weight_streetnet</a></span> <span class="op">(</span><span class="va">hampi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">from_id</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">to</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">from_id</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dens_from</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dens_to</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">to</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">dodgr_flows_si</span> <span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">graph</span>,</span></span>
<span class="r-in"><span>    from <span class="op">=</span> <span class="va">from</span>,</span></span>
<span class="r-in"><span>    to <span class="op">=</span> <span class="va">to</span>,</span></span>
<span class="r-in"><span>    dens_from <span class="op">=</span> <span class="va">dens_from</span>,</span></span>
<span class="r-in"><span>    dens_to <span class="op">=</span> <span class="va">dens_to</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># graph then has an additonal 'flows' column of aggregate flows along all</span></span></span>
<span class="r-in"><span><span class="co"># edges. These flows are directed, and can be aggregated to equivalent</span></span></span>
<span class="r-in"><span><span class="co"># undirected flows on an equivalent undirected graph with:</span></span></span>
<span class="r-in"><span><span class="va">graph_undir</span> <span class="op">&lt;-</span> <span class="fu"><a href="merge_directed_graph.html">merge_directed_graph</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># This graph will only include those edges having non-zero flows, and so:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6813</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span> <span class="op">(</span><span class="va">graph_undir</span><span class="op">)</span> <span class="co"># the latter is much smaller</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1288</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----- One dispersal coefficient for each origin point:</span></span></span>
<span class="r-in"><span><span class="co"># Remove `flow` column to avoid warning about over-writing values:</span></span></span>
<span class="r-in"><span><span class="va">graph</span><span class="op">$</span><span class="va">flow</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">dodgr_flows_si</span> <span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">graph</span>,</span></span>
<span class="r-in"><span>    from <span class="op">=</span> <span class="va">from</span>,</span></span>
<span class="r-in"><span>    to <span class="op">=</span> <span class="va">to</span>,</span></span>
<span class="r-in"><span>    dens_from <span class="op">=</span> <span class="va">dens_from</span>,</span></span>
<span class="r-in"><span>    dens_to <span class="op">=</span> <span class="va">dens_to</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="va">k</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span> <span class="op">(</span><span class="st">"^flow"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "flow"</span>
<span class="r-in"><span><span class="co"># single dispersal model; single "flow" column</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----- Multiple models, muliple dispersal coefficients:</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">graph</span><span class="op">$</span><span class="va">flow</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">dodgr_flows_si</span> <span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">graph</span>,</span></span>
<span class="r-in"><span>    from <span class="op">=</span> <span class="va">from</span>,</span></span>
<span class="r-in"><span>    to <span class="op">=</span> <span class="va">to</span>,</span></span>
<span class="r-in"><span>    dens_from <span class="op">=</span> <span class="va">dens_from</span>,</span></span>
<span class="r-in"><span>    dens_to <span class="op">=</span> <span class="va">dens_to</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="va">k</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span> <span class="op">(</span><span class="st">"^flow"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "flow1" "flow2" "flow3" "flow4" "flow5"</span>
<span class="r-in"><span><span class="co"># Rm all flow columns:</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span> <span class="op">(</span><span class="st">"^flow"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple models with unique coefficient at each origin point:</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">from</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span> <span class="op">(</span><span class="va">k</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10  5</span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu">dodgr_flows_si</span> <span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">graph</span>,</span></span>
<span class="r-in"><span>    from <span class="op">=</span> <span class="va">from</span>,</span></span>
<span class="r-in"><span>    to <span class="op">=</span> <span class="va">to</span>,</span></span>
<span class="r-in"><span>    dens_from <span class="op">=</span> <span class="va">dens_from</span>,</span></span>
<span class="r-in"><span>    dens_to <span class="op">=</span> <span class="va">dens_to</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="va">k</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span> <span class="op">(</span><span class="st">"^flow"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "flow1" "flow2" "flow3" "flow4" "flow5"</span>
<span class="r-in"><span><span class="co"># 5 "flow" columns again, but this time different dispersal coefficients each</span></span></span>
<span class="r-in"><span><span class="co"># each origin point.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Padgham, Andreas Petutschnig, David Cooley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

