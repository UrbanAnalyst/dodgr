<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Match spatial points to the edges of a spatial graph. — match_pts_to_graph • dodgr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match spatial points to the edges of a spatial graph. — match_pts_to_graph"><meta name="description" content="Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a dodgr_streetnet object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine."><meta property="og:description" content="Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a dodgr_streetnet object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dodgr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2.061</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UrbanAnalyst/dodgr"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Match spatial points to the edges of a spatial graph.</h1>
      <small class="dont-index">Source: <a href="https://github.com/UrbanAnalyst/dodgr/blob/main/R/match-points.R" class="external-link"><code>R/match-points.R</code></a></small>
      <div class="d-none name"><code>match_pts_to_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a <code>dodgr_streetnet</code> object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">match_pts_to_graph</span><span class="op">(</span><span class="va">graph</span>, <span class="va">xy</span>, connected <span class="op">=</span> <span class="cn">FALSE</span>, distances <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>A <code>dodgr</code> graph with spatial coordinates, such as a
<code>dodgr_streetnet</code> object.</p></dd>


<dt id="arg-xy">xy<a class="anchor" aria-label="anchor" href="#arg-xy"></a></dt>
<dd><p>coordinates of points to be matched to the vertices, either as
matrix or <span class="pkg">sf</span>-formatted <code>data.frame</code>.</p></dd>


<dt id="arg-connected">connected<a class="anchor" aria-label="anchor" href="#arg-connected"></a></dt>
<dd><p>Should points be matched to the same (largest) connected
component of graph? If <code>FALSE</code> and these points are to be used for a
<code>dodgr</code> routing routine (<a href="dodgr_dists.html">dodgr_dists</a>, <a href="dodgr_paths.html">dodgr_paths</a>, or
<a href="dodgr_flows_aggregate.html">dodgr_flows_aggregate</a>), then results may not be returned if points are
not part of the same connected component. On the other hand, forcing them to
be part of the same connected component may decrease the spatial accuracy of
matching.</p></dd>


<dt id="arg-distances">distances<a class="anchor" aria-label="anchor" href="#arg-distances"></a></dt>
<dd><p>If <code>TRUE</code>, return a 'data.frame' object with 'index' column
as described in return value; and additional columns with perpendicular
distance to nearest edge in graph, and coordinates of points of intersection.
See description of return value for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>distances = FALSE</code> (default), a vector index matching the <code>xy</code>
coordinates to nearest edges. For bi-directional edges, only one match is
returned, and it is up to the user to identify and suitably process matching
edge pairs. For 'distances = TRUE', a 'data.frame' of four columns:</p><ul><li><p>"index" The index of closest edges in "graph", as described above.</p></li>
<li><p>"d_signed" The perpendicular distance from ech point to the nearest
edge, with negative distances denoting points to the left of edges, and
positive distances denoting points to the right. Distances of zero denote
points lying precisely on the line of an edge (potentially including cases
where nearest point of bisection lies beyond the actual edge).</p></li>
<li><p>"x" The x-coordinate of the point of intersection.</p></li>
<li><p>"y" The y-coordinate of the point of intersection.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other match:
<code><a href="add_nodes_to_graph.html">add_nodes_to_graph</a>()</code>,
<code><a href="match_points_to_graph.html">match_points_to_graph</a>()</code>,
<code><a href="match_points_to_verts.html">match_points_to_verts</a>()</code>,
<code><a href="match_pts_to_verts.html">match_pts_to_verts</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="weight_streetnet.html">weight_streetnet</a></span> <span class="op">(</span><span class="va">hampi</span>, wt_profile <span class="op">=</span> <span class="st">"foot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Then generate some random points to match to graph</span></span></span>
<span class="r-in"><span><span class="va">verts</span> <span class="op">&lt;-</span> <span class="fu"><a href="dodgr_vertices.html">dodgr_vertices</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">npts</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span> <span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="va">npts</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="va">npts</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu">match_pts_to_graph</span> <span class="op">(</span><span class="va">graph</span>, <span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">[</span><span class="va">edges</span>, <span class="op">]</span> <span class="co"># The edges of the graph closest to `xy`</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        geom_num edge_id    from_id from_lon from_lat      to_id   to_lon</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201        203    6201 7769271419 76.37263 15.34499 7769190961 76.38203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395         89    3395 2588119056 76.42341 15.31717 2588146107 76.42349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3617         90    3617 2588155770 76.43412 15.32851 7794286097 76.43416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.1       89    3395 2588119056 76.42341 15.31717 2588146107 76.42349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.2       89    3395 2588119056 76.42341 15.31717 2588146107 76.42349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 503          18     503  339574188 76.44575 15.33279  339574189 76.44510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5919        183    5919 2398957539 76.47550 15.30880  676875267 76.47492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.3       89    3395 2588119056 76.42341 15.31717 2588146107 76.42349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201.1      203    6201 7769271419 76.37263 15.34499 7769190961 76.38203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4715        133    4715  338905103 76.46961 15.31386  338905105 76.47080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          to_lat          d d_weighted      highway    way_id component</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201   15.34708 1035.68141 2071.36283      primary 835018468         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395   15.31746   33.00845   41.26056 unclassified 252786290         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3617   15.32842   10.78597   11.35366        track 252787544         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.1 15.31746   33.00845   41.26056 unclassified 252786290         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.2 15.31746   33.00845   41.26056 unclassified 252786290         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 503    15.33287   70.55725   74.27078        track  30704678         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5919   15.30807  102.42454  204.84908      primary 652570479         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.3 15.31746   33.00845   41.26056 unclassified 252786290         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201.1 15.34708 1035.68141 2071.36283      primary 835018468         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4715   15.31338  138.14499  230.24166    secondary 327102382         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              time time_weighted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201   745.690618   1491.381236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395    23.766081     29.707601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3617     7.765901      8.174633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.1  23.766081     29.707601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.2  23.766081     29.707601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 503     50.801217     53.474965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5919    73.745670    147.491340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395.3  23.766081     29.707601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201.1 745.690618   1491.381236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4715    99.464395    165.773992</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Padgham, Andreas Petutschnig, David Cooley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

