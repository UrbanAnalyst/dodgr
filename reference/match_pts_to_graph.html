<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Match spatial points to the edges of a spatial graph. — match_pts_to_graph • dodgr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match spatial points to the edges of a spatial graph. — match_pts_to_graph"><meta name="description" content="Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a dodgr_streetnet object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine."><meta property="og:description" content="Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a dodgr_streetnet object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dodgr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1.026</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UrbanAnalyst/dodgr"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Match spatial points to the edges of a spatial graph.</h1>
      <small class="dont-index">Source: <a href="https://github.com/UrbanAnalyst/dodgr/blob/main/R/match-points.R" class="external-link"><code>R/match-points.R</code></a></small>
      <div class="d-none name"><code>match_pts_to_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a <code>dodgr_streetnet</code> object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">match_pts_to_graph</span><span class="op">(</span><span class="va">graph</span>, <span class="va">xy</span>, connected <span class="op">=</span> <span class="cn">FALSE</span>, distances <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>A <code>dodgr</code> graph with spatial coordinates, such as a
<code>dodgr_streetnet</code> object.</p></dd>


<dt id="arg-xy">xy<a class="anchor" aria-label="anchor" href="#arg-xy"></a></dt>
<dd><p>coordinates of points to be matched to the vertices, either as
matrix or <span class="pkg">sf</span>-formatted <code>data.frame</code>.</p></dd>


<dt id="arg-connected">connected<a class="anchor" aria-label="anchor" href="#arg-connected"></a></dt>
<dd><p>Should points be matched to the same (largest) connected
component of graph? If <code>FALSE</code> and these points are to be used for a
<code>dodgr</code> routing routine (<a href="dodgr_dists.html">dodgr_dists</a>, <a href="dodgr_paths.html">dodgr_paths</a>, or
<a href="dodgr_flows_aggregate.html">dodgr_flows_aggregate</a>), then results may not be returned if points are
not part of the same connected component. On the other hand, forcing them to
be part of the same connected component may decrease the spatial accuracy of
matching.</p></dd>


<dt id="arg-distances">distances<a class="anchor" aria-label="anchor" href="#arg-distances"></a></dt>
<dd><p>If <code>TRUE</code>, return a 'data.frame' object with 'index' column
as described in return value; and additional columns with perpendicular
distance to nearest edge in graph, and coordinates of points of intersection.
See description of return value for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>distances = FALSE</code> (default), a vector index matching the <code>xy</code>
coordinates to nearest edges. For bi-directional edges, only one match is
returned, and it is up to the user to identify and suitably process matching
edge pairs. For 'distances = TRUE', a 'data.frame' of four columns:</p><ul><li><p>"index" The index of closest edges in "graph", as described above.</p></li>
<li><p>"d_signed" The perpendicular distance from ech point to the nearest
edge, with negative distances denoting points to the left of edges, and
positive distances denoting points to the right. Distances of zero denote
points lying precisely on the line of an edge (potentially including cases
where nearest point of bisection lies beyond the actual edge).</p></li>
<li><p>"x" The x-coordinate of the point of intersection.</p></li>
<li><p>"y" The y-coordinate of the point of intersection.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other match:
<code><a href="add_nodes_to_graph.html">add_nodes_to_graph</a>()</code>,
<code><a href="match_points_to_graph.html">match_points_to_graph</a>()</code>,
<code><a href="match_points_to_verts.html">match_points_to_verts</a>()</code>,
<code><a href="match_pts_to_verts.html">match_pts_to_verts</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="weight_streetnet.html">weight_streetnet</a></span> <span class="op">(</span><span class="va">hampi</span>, wt_profile <span class="op">=</span> <span class="st">"foot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Then generate some random points to match to graph</span></span></span>
<span class="r-in"><span><span class="va">verts</span> <span class="op">&lt;-</span> <span class="fu"><a href="dodgr_vertices.html">dodgr_vertices</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">npts</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span> <span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="va">npts</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="va">npts</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu">match_pts_to_graph</span> <span class="op">(</span><span class="va">graph</span>, <span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">[</span><span class="va">edges</span>, <span class="op">]</span> <span class="co"># The edges of the graph closest to `xy`</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      geom_num edge_id    from_id from_lon from_lat      to_id   to_lon   to_lat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5925      183    5925 2398957516 76.47461 15.30765  676635868 76.47446 15.30734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2733       70    2733 4474520380 76.48887 15.32820 4474520379 76.48903 15.32825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4563      129    4563 5358983985 76.45981 15.32519 1148815010 76.45980 15.32528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395       89    3395 2588119056 76.42341 15.31717 2588146107 76.42349 15.31746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6237      203    6237 1388483320 76.40250 15.35238 1388482647 76.40387 15.35230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6209      203    6209 1388482509 76.38860 15.34745 1204772662 76.38895 15.34748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241      203    6241 1204772675 76.40457 15.35226 1204772877 76.40606 15.35237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6211      203    6211 1204772662 76.38895 15.34748 1204772772 76.38938 15.34775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201      203    6201 7769271419 76.37263 15.34499 7769190961 76.38203 15.34708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6255      203    6255 1388482473 76.42580 15.35076 1204772830 76.42729 15.35071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               d d_weighted      highway    way_id component       time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5925   37.85114   75.70227      primary 652570479         1  27.252818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2733   18.28658   18.28658         path 123463598         1  13.166338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4563   10.67810   17.79684    secondary 327102372         1   7.688233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395   33.00845   41.26056 unclassified 252786290         1  23.766081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6237  146.93904  293.87809      primary 835018468         2 105.796112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6209   38.16886   76.33773      primary 835018468         2  27.481581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241  160.21420  320.42840      primary 835018468         2 115.354224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6211   55.47203  110.94405      primary 835018468         2  39.939860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201 1035.68141 2071.36283      primary 835018468         2 745.690618</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6255  160.53814  321.07628      primary 835018468         2 115.587460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      time_weighted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5925      54.50564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2733      13.16634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4563      12.81372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3395      29.70760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6237     211.59222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6209      54.96316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241     230.70845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6211      79.87972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6201    1491.38124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6255     231.17492</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Padgham, Andreas Petutschnig, David Cooley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

