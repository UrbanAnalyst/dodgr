<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a dodgr_streetnet object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine."><title>Match spatial points to the edges of a spatial graph. — match_pts_to_graph • dodgr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Match spatial points to the edges of a spatial graph. — match_pts_to_graph"><meta property="og:description" content="Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a dodgr_streetnet object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dodgr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.20.023</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ATFutures/dodgr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Match spatial points to the edges of a spatial graph.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ATFutures/dodgr/blob/HEAD/R/match-points.R" class="external-link"><code>R/match-points.R</code></a></small>
      <div class="d-none name"><code>match_pts_to_graph.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Match spatial points to the edges of a spatial graph, through finding the
edge with the closest perpendicular intersection. NOTE: Intersections are
calculated geometrically, and presume planar geometry. It is up to users of
projected geometrical data, such as those within a <code>dodgr_streetnet</code> object,
to ensure that either: (i) Data span an sufficiently small area that errors
from presuming planar geometry may be ignored; or (ii) Data are re-projected
to an equivalent planar geometry prior to calling this routine.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">match_pts_to_graph</span><span class="op">(</span><span class="va">graph</span>, <span class="va">xy</span>, connected <span class="op">=</span> <span class="cn">FALSE</span>, distances <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>graph</dt>
<dd><p>A <code>dodgr</code> graph with spatial coordinates, such as a
<code>dodgr_streetnet</code> object.</p></dd>


<dt>xy</dt>
<dd><p>coordinates of points to be matched to the vertices, either as
matrix or <span class="pkg">sf</span>-formatted <code>data.frame</code>.</p></dd>


<dt>connected</dt>
<dd><p>Should points be matched to the same (largest) connected
component of graph? If <code>FALSE</code> and these points are to be used for a
<code>dodgr</code> routing routine (<a href="dodgr_dists.html">dodgr_dists</a>, <a href="dodgr_paths.html">dodgr_paths</a>, or
<a href="dodgr_flows_aggregate.html">dodgr_flows_aggregate</a>), then results may not be returned if points are
not part of the same connected component. On the other hand, forcing them to
be part of the same connected component may decrease the spatial accuracy of
matching.</p></dd>


<dt>distances</dt>
<dd><p>If <code>TRUE</code>, return a 'data.frame' object with 'index' column
as described in return value; and additional columns with perpendicular
distance to nearest edge in graph, and coordinates of points of intersection.
See description of return value for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For <code>distances = FALSE</code> (default), a vector index matching the <code>xy</code></p>


<p>coordinates to nearest edges. For bi-directional edges, only one match is
returned, and it is up to the user to identify and suitably process matching
edge pairs. For 'distances = TRUE', a 'data.frame' of four columns:</p><ul><li><p>"index" The index of closest edges in "graph", as described above.</p></li>
<li><p>"d_signed" The perpendicular distance from ech point to the nearest
edge, with negative distances denoting points to the left of edges, and
positive distances denoting points to the right. Distances of zero denote
points lying precisely on the line of an edge (potentially including cases
where nearest point of bisection lies beyond the actual edge).</p></li>
<li><p>"x" The x-coordinate of the point of intersection.</p></li>
<li><p>"y" The y-coordinate of the point of intersection.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other match: 
<code><a href="add_nodes_to_graph.html">add_nodes_to_graph</a>()</code>,
<code><a href="match_points_to_graph.html">match_points_to_graph</a>()</code>,
<code><a href="match_points_to_verts.html">match_points_to_verts</a>()</code>,
<code><a href="match_pts_to_verts.html">match_pts_to_verts</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="weight_streetnet.html">weight_streetnet</a></span> <span class="op">(</span><span class="va">hampi</span>, wt_profile <span class="op">=</span> <span class="st">"foot"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Then generate some random points to match to graph</span></span></span>
<span class="r-in"><span><span class="va">verts</span> <span class="op">&lt;-</span> <span class="fu"><a href="dodgr_vertices.html">dodgr_vertices</a></span> <span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">npts</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span> <span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="va">npts</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span> <span class="op">(</span><span class="va">npts</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span> <span class="op">(</span><span class="va">verts</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu">match_pts_to_graph</span> <span class="op">(</span><span class="va">graph</span>, <span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graph</span> <span class="op">[</span><span class="va">edges</span>, <span class="op">]</span> <span class="co"># The edges of the graph closest to `xy`</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        geom_num edge_id    from_id from_lon from_lat      to_id   to_lon</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5517        169    5517 4506481406 76.46174 15.31509 4506481407 76.46154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6239        203    6239 1388482647 76.40387 15.35230 1204772675 76.40457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6247        203    6247 1204772780 76.40951 15.35236 1204772868 76.41809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241        203    6241 1204772675 76.40457 15.35226 1204772877 76.40606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3253         85    3253 2195425109 76.45403 15.35955 2195425106 76.45432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6249        203    6249 1204772868 76.41809 15.35157 6597298435 76.42010</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3473         89    3473 7793361778 76.43309 15.31772 7793361779 76.43379</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5851        183    5851  245631169 76.48423 15.32007 7806119997 76.48362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241.1      203    6241 1204772675 76.40457 15.35226 1204772877 76.40606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1311         35    1311 1206252905 76.49212 15.35451  571423209 76.49232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          to_lat         d d_weighted      highway    way_id component      time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5517   15.31516  23.36460   24.59432        track 454003193         1  16.82252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6239   15.35226  75.74146  151.48292      primary 835018468         2  54.53385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6247   15.35157 925.87357 1851.74714      primary 835018468         2 666.62897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241   15.35237 160.21420  320.42840      primary 835018468         2 115.35422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3253   15.35937  37.11878   37.11878         path 209318367         2  26.72552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6249   15.35136 216.89113  433.78226      primary 835018468         2 156.16161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3473   15.31763  75.91522   94.89403 unclassified 252786290         1  54.65896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5851   15.31985  70.40027  140.80055      primary 652570479         1  50.68820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241.1 15.35237 160.21420  320.42840      primary 835018468         2 115.35422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1311   15.35470  29.77597   59.55195      primary  53658844         2  21.43870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        time_weighted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5517        17.70791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6239       109.06770</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6247      1333.25794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241       230.70845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3253        26.72552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6249       312.32323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3473        68.32370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5851       101.37639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6241.1     230.70845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1311        42.87740</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mark Padgham, Andreas Petutschnig, David Cooley.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

